<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HelloEvent</title>
</head>
<script src="../../build/try3d.min.js"></script>
<script src="../helpers.js"></script>
<body>
    <div style="width: 100%;height: 100%;position:fixed;margin: 0px;padding: 0px;left: 0px;top: 0px;margin: 0px;">
        <canvas id="canvas" style="padding: 0px;margin: 0px;position:absolute;left: 0px;top: 0px;background-color: aliceblue" tabindex="0"></canvas>
    </div>
    <script type="module">

        // åˆ›å»ºåœºæ™¯å¯¹è±¡(æ¸²æŸ“å™¨è‡³å°‘åŒ…å«ä¸€ä¸ªscene,å¦åˆ™,å°†ä»€ä¹ˆäº‹æƒ…éƒ½ä¸åš)
        let scene = new Try3d.Scene({cavnas:document.getElementById('canvas')});
        scene.getCanvas().setClearColor(1.0, 1.0, 1.0, 1.0);
        // å†…ç½®ColorDef
        let colorDef = Try3d.MaterialDef.parse(Try3d.Internal.S_COLOR_DEF_DATA);

        // å®šä¹‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹
        let rootNode = new Try3d.Node(scene, {id:'rootNode'});
        scene.addSceneNode(rootNode);


        let objLoader = new Try3d.OBJLoader();
        objLoader.load(scene, 'blackboardOBJ', './../Assets/Models/OBJ/blackboard2.obj', modelNode=>{
            modelNode.setLocalScaleXYZ(0.1, 0.1, 0.1);
            modelNode.setLocalRotationFromEuler(0, Try3d.MoreMath.toRadians(-90), 0);
            rootNode.addChildren(modelNode);
            // å®šä¹‰ä¸€ä¸ªé»‘æ¿(å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥ä»åŠ è½½çš„objæ¨¡å‹ä¸­è·å–é»‘æ¿èŠ‚ç‚¹,ä½†æ˜¯è¿™ä¸ªæ¨¡å‹è¢«ä¼˜åŒ–ä¸ºä¸€ä¸ªæ•´ä½“äº†)
            let blackboard = new Try3d.GroupPlane(scene, {id:'blackboard', xSize:3.8, zSize:3.4});
            let blackboardMat = new Try3d.Material(scene, {id:'blackboardMat', materialDef:colorDef});
            let blackboardTexture = new Try3d.Texture2DVars(scene);
            let textImage = new Try3d.TextImage(512, 512, 'è¯·æŒ‰ä¸‹ä»»æ„æŒ‰é”®(ğŸ˜€)', 50, '#191919');
            // æ–‡æœ¬å¯¹é½æ–¹å¼(0.5,0.5è¡¨ç¤ºæ°´å¹³å‚ç›´ä¸­å¿ƒ)
            textImage.setAlign(0.5, 0.5);
            // æ–‡æœ¬é¢œè‰²
            textImage.setTextColor('white');
            blackboardTexture.setImage(scene, textImage.getImage());
            blackboardTexture.setFlipY(true);
            blackboardMat.setParam('colorMap', blackboardTexture);
            blackboard.setMaterial(blackboardMat);
            // è¿™é‡Œä»…ä»…åªæ˜¯ä¸ºäº†å°†è¿™ä¸ªblackboardæ”¾åˆ°ä¸ä¸Šé¢åŠ è½½çš„æ¨¡å‹é»‘æ¿ä½ç½®
            blackboard.setLocalRotationFromEuler(Try3d.MoreMath.toRadians(90), Try3d.MoreMath.toRadians(90), 0);
            blackboard.setLocalTranslationXYZ(0, 6.1, -0.12);
            rootNode.addChildren(blackboard);

            // åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨
            let sceneControl = new Try3d.SceneBrowsingController(scene, {id:'control'});
            sceneControl.lookScene(rootNode);
            sceneControl.setTargetDistance(12);
            initOther(scene, rootNode);
            // è·å–å½“å‰é»˜è®¤çš„çª—å£è¾“å…¥æ§åˆ¶å™¨
            let input = Try3d.Input.getInput(scene, {id:scene.getId()});
            // åœ¨æ›´æ–°å¾ªç¯ä¸­ç›‘å¬äº‹ä»¶(æˆ–è€…ä»¥åŸç”Ÿhtmlæ–¹å¼ç›‘å¬)
            // è¿™é‡Œç”±äºä¾‹å­éœ€è¦ç›‘å¬æ‰€æœ‰æŒ‰é”®äº‹ä»¶,æ‰€ä»¥åœ¨ä¿¡å·ä¸­ç›‘å¬æ‰€æœ‰æŒ‰ä¸‹äº‹ä»¶
            input.on('keydown', (event)=>{
                if(event){
                    textImage.setText('æŒ‰ä¸‹çš„keyCode:' + event);
                    blackboardTexture.setImage(scene, textImage.getImage());
                }
            });
        });



        // åˆ›å»ºæ¸²æŸ“å™¨
        let renderEngine = new Try3d.RenderEngine();
        // æ·»åŠ è¦æ¸²æŸ“çš„åœºæ™¯å¯¹è±¡
        renderEngine.addScene(scene);
        // å¯åŠ¨æ¸²æŸ“å™¨
        renderEngine.launch();
        showStats(scene);
    </script>
</body>
</html>
